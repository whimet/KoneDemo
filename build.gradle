apply plugin: 'idea'
apply plugin: 'java'
apply plugin: 'war'

repositories {
    mavenCentral()
}

war {
    baseName = 'kone'
}

dependencies {
    compile 'org.mortbay.jetty:jetty:6.1.26'
    compile 'org.eclipse.jetty:jetty-jsp-2.1:7.1.0.RC1'
    testCompile group: 'junit', name: 'junit', version: '4.+'
    testCompile 'net.sourceforge.htmlunit:webdriver:2.6'
}

task jetty << {
    ant.java(classname: 'demo.JettyServer', classpath: configurations.runtime.plus(sourceSets.main.output).asPath)
}

task run(dependsOn: jetty) << {
    sleep(Long.MAX_VALUE)
}

test {
    dependsOn jetty
}